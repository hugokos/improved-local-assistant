[tox]
envlist = py310,py311,py312,lint,typecheck
skip_missing_interpreters = true

[testenv]
deps = -r requirements.txt
       -e .
       -c constraints.txt
commands =
    python -m pip check
    pytest -q --cov=improved_local_assistant --cov-report=xml --fail-under=70

[testenv:lint]
deps = -r requirements.txt
       -e .
       -c constraints.txt
commands =
    ruff check .
    black --check .

[testenv:typecheck]
deps = -r requirements.txt
       -e .
       -c constraints.txt
commands = mypy src

[testenv:smoke]
deps = -r requirements.txt
       -e .
       -c constraints.txt
commands = pytest -q -m smoke

[testenv:security]
deps = -r requirements.txt
       -e .
       -c constraints.txt
commands =
    bandit -r src/ -ll
    safety check --full-report